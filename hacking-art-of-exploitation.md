# Notas sobre hacking the art of exploitation - Segunda edicion

## Utilidades
Muchas utilidades para linux tambien se pueden instalar en mac usando herramientas como ports o homebrew y los comandos para invocar las utilidades son los mismos con la diferencia de que muchos de ellos **se preceden por una letra g**. 

*Ejemplo: Para el comando `gdb` en Linux, en MacOS lo instalo con el comando `sudo port install gdb` y luego lo puedo utilizar con `ggdb`
Lo mismo se aplica para `objdump`, se llama con `gobjdump`*

### Disassembler
    objdump -D EJECUTABLE
#### Parametros:
    -M intel //sintaxis intel en lugar de AT&T por defecto

#### MacOS
    otool -tV // ya viene con xcode tools en mac

### Debugger
	gdb
Es complicado hacer funcionar gdb en MacOS El capitan, hice todo los pasos pero sigue sin funcionar: 
<http://stackoverflow.com/questions/33162757/how-to-install-gdb-debugger-in-mac-osx-el-capitan>
#### MacOS
	lldb // usa diferentes comandos a gdb

### gdb: Como debuggear a bajo nivel un programa compilado en C
	gdb -q ./a.out // -q quiet, evita que se imprima el texto de licencia, etc
	break main
	run
	i[nfo] r[egisters] [name] //ver la informacion de los registros del cpu
							  // u opcionalmente de uno solo en especial
							  // se puede abreviar info solo con i, registers con r
	
	set disassembly-flavor intel // setea la sintaxis de desamblaje a intel
								 // para setearla permanente se puede crear/modificar el
								 // archivo ~/.gdbinit con dicho comando

#### Si el ejecutable fue compilado con gcc -g:
	list // muestra el codigo fuente del ejecutable 
	dissasemble main // desensambla solo el maina

#### Examinar direcciones de memoria
	x[/AFB] 	//examina direcciones de memoria con parametros opcionales
	x 0x400535  //examina la direccion de memoria 0x400535
	x $eip 		//examina la direccion de memoria guardada en el registro eip
	x/Ai $rip 	// me muestra la instruccion a la que corresponde 

	F = [oxut] 	//formato: octal, hexa, unsigned o binario respectivamente
	A = Numero 	// Cantidad de unidades a examinar
	B = b/h/w/g // se puede especificar tambien el tamaño de lo que
	 			// examina: 1/2/4/8 bytes - byte/halfword/word/giant

**Notar:** Como la arquitectura x86 es little endian hacer `x/2xb $eip` muestra: **`0xc7 0x45`** y `x/xw $eip` muestra: **`0x45c7`** (estan *"dados vuelta"*) lo cual tiene sentido.

#### Avanzar IP
Leer la siguiente instruccion en IP, ejecutarla, y avanzar el IP a la siguiente instrucción:

	nexti

#### Conversion a string y character

	x/cb
	Con la s puedo indicar que quiero que lo muestre como caracter

	x/s
	Con la s puedo indicar que quiero que lo muestre como un string

##### Extra: Utilidad para ver tabla ascii (en terminal, fuera de gdb)

	man ascii

Tabla ascii (para investigar la memoria con datos que son letras, numeros, etc)

#### Backtrace

	bt

Backtrace, hace un "rastreo" hacia atras, en el stack, mirando las direcciones de retorno que hay apiladas para saber desde donde viene la ejecucion actual del programa (cada invocacion a una funcion apila en el stack la direccion de retorno).

	cont

Se escribe `cont` luego de un `bt` para continuar con el debuging.

> Creditos a: Jon Erickson. "Hacking: The Art of Exploitation, 2nd Edition."
